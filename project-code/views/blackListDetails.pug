<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css">
    <title>Hello, world!</title>
    //- <style>
    //-   table th td {
    //-     border:1px solid black;
    //-   }
    //- </style>
</head>

<body>
    
  <ul class="nav justify-content-center bg-dark py-2">
      <li class="nav-item">
        <a style="color:#f54a06" class="nav-link active" aria-current="page" href="/">NERDpast</a>
      </li>
      <li class="nav-item ">
        <a class="nav-link text-light" href="/NERDpast/emailValidate">Email-Validate</a>
      </li>
      <li class="nav-item">
        <a class="nav-link text-light" href="/NERDpast/blacklist-ip">FMP</a>
      </li>
      <li class="nav-item">
        <a class="nav-link text-light" href="/NERDpast/phoneValidate">Phone Validator</a>
      </li>
      <li class="nav-item">
        <a class="nav-link text-light" href="/NERDpast/wordFilter">Word Filter</a>
      </li>
  </ul>

        
  <div class="container text-center mt-5">
    <div class="row">
        <div id="blacklist-detail"class=" col-md-6 col-12">
            
            <h5>Ip: #{data.ip}</h5>
            - if(data['is-bot']==true){
                <h5 class="text-dark bg-danger">Is-bot : #{data['is-bot']}</h5>
            -}else{
                <h5 class="text-light bg-success">Is-bot : #{data['is-bot']}</h5>
            -}

            - if(data['is-dshield']==true){
                <h5 class="text-dark bg-danger">Is-dshield : #{data['is-dshield']}</h5>
            -}else{
                <h5 class="text-light bg-success">Is-dshield : #{data['is-dshield']}</h5>
            -}

            - if(data['is-exploit-bot']==true){
                <h5 class="text-dark bg-danger">Is-exploit-bot : #{data['is-exploit-bot']}</h5>
            -}else{
                <h5 class="text-light bg-success">Is-exploit-bot : #{data['is-exploit-bot']}</h5>
            -}
            
            - if(data['is-hijacked']==true){
                <h5 class="text-dark bg-danger">Is-hijacked : #{data['is-hijacked']}</h5>
            -}else{
                <h5 class="text-light bg-success">Is-hijacked : #{data['is-hijacked']}</h5>
            -}

            - if(data['is-listed']==true){
                <h5 class="text-dark bg-danger">Is-listed : #{data['is-listed']}</h5>
            -}else{
                <h5 class="text-light bg-success">Is-listed : #{data['is-listed']}</h5>
            -}

            - if(data['is-malware']==true){
                <h5 class="text-dark bg-danger">is-malware : #{data['is-malware']}</h5>
            -}else{
                <h5 class="text-light bg-success">is-malware : #{data['is-malware']}</h5>
            -}

            - if(data['is-proxy']==true){
                <h5 class="text-dark bg-danger">Is-proxy : #{data['is-proxy']}</h5>
            -}else{
                <h5 class="text-light bg-success">Is-proxy : #{data['is-proxy']}</h5>
            -}

            - if(data['is-spam-bot']==true){
                <h5 class="text-dark bg-danger">Is-spam-bot : #{data['is-spam-bot']}</h5>
            -}else{
                <h5 class="text-light bg-success">Is-spam-bot : #{data['is-spam-bot']}</h5>
            -}

            - if(data['is-spider']==true){
                <h5 class="text-dark bg-danger">Is-spider : #{data['is-spider']}</h5>
            -}else{
                <h5 class="text-light bg-success">Is-spider : #{data['is-spider']}</h5>
            -}

            - if(data['is-spyware']==true){
                <h5 class="text-dark bg-danger">Is-spyware : #{data['is-spyware']}</h5>
            -}else{
                <h5 class="text-light bg-success">Is-spyware : #{data['is-spyware']}</h5>
            -}

            - if(data['is-tor']==true){
                <h5 class="text-dark bg-danger">Is-tor : #{data['is-tor']}</h5>
            -}else{
                <h5 class="text-light bg-success">Is-tor : #{data['is-tor']}</h5>
            -}

            - if(data['is-vpn']==true){
                <h5 class="text-dark bg-danger">Is-vpn : #{data['is-vpn']}</h5>
            -}else{
                <h5 class="text-light bg-success">Is-vpn : #{data['is-vpn']}</h5>
            -}

            - if(data['last-seen']==true){
                <h5 class="text-dark bg-danger">Last-seen : #{new Date(data['last-seen']* 1000)}</h5>
            -}else{
                <h5 class="text-light bg-success">Last-seen : #{new Date(data['last-seen']* 1000)}</h5>
            -}

            //- - if(data['list-count']==true){
            //-     <h5 class="text-dark bg-danger">List-count : #{data['list-count']}</h5>
            //- -}else{
            //-     <h5 class="text-light bg-success">List-count : #{data['list-count']}</h5>
            //- -}
        </div>

        <div class="col-md-6 col-12">
          <h3>List of Sensors used to detected this IP</h3>
          - for (var i = 0; i < data.sensors.length; ++i) {
              <div class="bg-primary text-light my-2">
                <h5>BlockList Type : #{data.sensors[i].blocklist}</h5>
                <h5>Desciption : #{data.sensors[i].description}</h5>
              </div>
          - }
        </div>
    </div>
    <h2 class="mt-5">Meaning of Keywords Used</h2>
    <div class="container mt-5">
        <table style="width:100%;border:1px solid black;">
          <tr style="border:2px solid black">
            <th>Keyword</th>
            <th>Type</th>
            <th>Description</th>
          </tr>
          <tr style="border:2px solid black">
            <td>is-listed</td>
            <td>boolean</td>
            <td>Is this IP on a blocklist</td>
          </tr>
          <tr style="border:2px solid black">
            <td>last-seen</td>
            <td>integer</td>
            <td>The last time this IP was seen on a blocklist (in Unix time or 0 if not listed recently)</td>
          </tr>
          <tr style="border:2px solid black">
            <td>list-count</td>
            <td>integer</td>
            <td>The number of blocklists the IP is listed on</td>
          </tr>
          <tr style="border:2px solid black">
            <td>blocklists</td>
            <td>array</td>
            <td>An array of strings indicating which blocklists this IP is listed on (empty if not listed)</td>
          </tr>
          <tr style="border:2px solid black">
            <td>sensors</td>
            <td>array</td>
            <td>An array of objects containing details on which sensors were used to detect this IP</td>
          </tr>
          <tr style="border:2px solid black">
            <td>last-seen</td>
            <td>integer</td>
            <td>The last time this IP was seen on a blocklist (in Unix time or 0 if not listed recently)</td>
          </tr>
          <tr style="border:2px solid black">
            <td>is-proxy</td>
            <td>boolean</td>
            <td>IP has been detected as an anonymous web proxy or anonymous HTTP proxy</td>
          </tr>
          <tr style="border:2px solid black">
            <td>is-tor</td>
            <td>boolean</td>
            <td>IP is a Tor node or running a Tor related service</td>
          </tr>
          <tr style="border:2px solid black">
            <td>is-vpn</td>
            <td>boolean</td>
            <td>IP belongs to a public VPN provider (only set if the 'vpn-lookup' option is enabled)</td>
          </tr>
          <tr style="border:2px solid black">
            <td>is-malware	</td>
            <td>boolean</td>
            <td>IP is involved in distributing or is running malware</td>
          </tr>
          <tr style="border:2px solid black">
            <td>is-spyware</td>
            <td>boolean</td>
            <td>IP is involved in distributing or is running spyware</td>
          </tr>
          <tr style="border:2px solid black">
            <td>is-dshield</td>
            <td>boolean</td>
            <td>IP has been flagged as an attack source on DShield (dshield.org)</td>
          </tr>
          <tr style="border:2px solid black">
            <td>is-hijacked</td>
            <td>boolean</td>
            <td>IP is part of a hijacked netblock or a netblock controlled by a criminal organization</td>
          </tr>
          <tr style="border:2px solid black">
            <td>is-spider	</td>
            <td>boolean</td>
            <td>IP is running a hostile web spider / web crawler</td>
          </tr>
          <tr style="border:2px solid black">
            <td>is-bot</td>
            <td>boolean</td>
            <td>IP is hosting a malicious bot or is part of a botnet. Includes brute-force crackers</td>
          </tr>
          <tr style="border:2px solid black">
            <td>is-spam-bot</td>
            <td>boolean</td>
            <td>IP address is hosting a spam bot, comment spamming or any other spamming type software</td>
          </tr>
          <tr style="border:2px solid black">
            <td>is-exploit-bot	</td>
            <td>boolean</td>
            <td>IP is hosting an exploit finding bot or is running exploit scanning software</td>
          </tr>
        </table>
    </div>
  


    -var fmp=0
    
    - if(data['is-bot']==true){
        //- <h5 class="text-dark bg-danger">Is-bot : #{data['is-bot']}</h5>
        -fmp+=8
    -}

    - if(data['is-dshield']==true){
        //- <h5 class="text-dark bg-danger">Is-dshield : #{data['is-dshield']}</h5>
        -fmp+=9
    -}

    - if(data['is-exploit-bot']==true){
        //- <h5 class="text-dark bg-danger">Is-exploit-bot : #{data['is-exploit-bot']}</h5>
        -fmp+=7
    -}
    
    - if(data['is-hijacked']==true){
        //- <h5 class="text-dark bg-danger">Is-hijacked : #{data['is-hijacked']}</h5>
        -fmp+=6
    -}

    - if(data['is-listed']==true){
        //- <h5 class="text-dark bg-danger">Is-listed : #{data['is-listed']}</h5>
        -fmp+=9.5
    -}

    - if(data['is-malware']==true){
        //- <h5 class="text-dark bg-danger">is-malware : #{data['is-malware']}</h5>
        -fmp+=9
    -}

    - if(data['is-proxy']==true){
        //- <h5 class="text-dark bg-danger">Is-proxy : #{data['is-proxy']}</h5>
        -fmp+=5
    -}

    - if(data['is-spam-bot']==true){
        //- <h5 class="text-dark bg-danger">Is-spam-bot : #{data['is-spam-bot']}</h5>
        -fmp+=8
    -}

    - if(data['is-spider']==true){
        //- <h5 class="text-dark bg-danger">Is-spider : #{data['is-spider']}</h5>
        -fmp+=7
    -}

    - if(data['is-spyware']==true){
        //- <h5 class="text-dark bg-danger">Is-spyware : #{data['is-spyware']}</h5>
        -fmp+=8
    -}

    - if(data['is-tor']==true){
        //- <h5 class="text-dark bg-danger">Is-tor : #{data['is-tor']}</h5>
        -fmp+=7
    -}
    
    <div class="py-5 bg-info text-light" id="fmp-cal">
      <h1>The Future Malicious Probability Score is : #{fmp/110}</h1>

      <h3>Rules for calculating FMP score</h3>
      <p>11 different parameters have been taken into account while calculating the FMP score. It covers wide range of attacks including Malware, bots, dshield, tor, spyware etc. Each attack has a different weightage based on easy of resources available for attack and severity of attack caused by such attack</p>
      <ol>
        <li>Malwares have a weightage of .09</li>
        <li>Bots have a weightage of 0.07/0.08</li>
        <li>Spywares have weightage of 0.08</li>
        <li>Tor-node has a weightage of 0.07</li>
        <li>Dsheild has a weightage of 0.08</li>
        <li>proxy has a weightage of 0.05</li>

      </ol>
    </div> 
  </div>     
        
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"crossorigin="anonymous"></script>
</body>

</html>